# Example Home Assistant configuration for NEC TV Control
# Add this to your configuration.yaml

# REST switch for NEC TV Power Control with actual state detection
switch:
  - platform: rest
    name: "NEC TV Power"
    resource: "http://localhost:8124/power"
    body_on: '{"action": "on"}'
    body_off: '{"action": "off"}'
    headers:
      Content-Type: application/json
    is_on_template: "{{ value_json.is_on }}"

# REST sensor for NEC TV Brightness (read current value)
sensor:
  - platform: rest
    name: "NEC TV Brightness"
    resource: "http://localhost:8124/brightness"
    headers:
      Content-Type: application/json
    value_template: "{{ value_json.percentage }}"
    unit_of_measurement: "%"
    icon: mdi:brightness-6

# Template Number for direct brightness control (no automation needed!)
template:
  - number:
      - name: "NEC TV Brightness Control"
        unique_id: nec_tv_brightness_control
        min: "0"
        max: "100"
        step: "5"
        icon: mdi:brightness-6
        state: "{{ states('sensor.nec_tv_brightness') | int(0) }}"
        set_value:
          - action: rest_command.set_nec_tv_brightness
            data:
              brightness: "{{ value | int }}"

# REST command for setting brightness
rest_command:
  set_nec_tv_brightness:
    url: "http://localhost:8124/brightness"
    method: POST
    headers:
      Content-Type: application/json
    payload: '{"brightness": {{ brightness }}}'

# Optional: Create a group for easier control
group:
  nec_tv:
    name: NEC TV
    entities:
      - switch.nec_tv_power

# Optional: Create automations
automation:
  # Turn off TV when leaving home
  - alias: "Turn off TV when leaving"
    trigger:
      platform: state
      entity_id: group.all_devices
      to: "not_home"
    action:
      - service: switch.turn_off
        target:
          entity_id: switch.nec_tv_power

  # Turn on TV when arriving home (if it's evening)
  - alias: "Turn on TV when arriving home in evening"
    trigger:
      platform: state
      entity_id: group.all_devices
      to: "home"
    condition:
      - condition: time
        after: "18:00:00"
        before: "23:00:00"
    action:
      - service: switch.turn_on
        target:
          entity_id: switch.nec_tv_power 